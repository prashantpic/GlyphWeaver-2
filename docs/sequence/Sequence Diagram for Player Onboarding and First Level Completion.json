
{
  "mermaidDiagram": "sequenceDiagram\n    actor \"Player\" as playeractor\n    participant \"Unity Client\" as REPOGLYPHCLIENTUNITY\n    actor \"Platform Services\" as platformservicesactor\n    participant \"Auth Service\" as REPOGLYPHAUTH\n    participant \"Player Service\" as REPOGLYPHPLAYER\n    participant \"Leaderboard Service\" as REPOGLYPHLEADERBOARD\n    \n    playeractor->>REPOGLYPHCLIENTUNITY: 1. Launches Game\n    activate REPOGLYPHCLIENTUNITY\n    REPOGLYPHCLIENTUNITY-->>playeractor: 2. Displays Main Menu\n    playeractor->>REPOGLYPHCLIENTUNITY: 3. Taps \"Start Game\"\n    REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 4. Checks for existing session (is first launch)\n    REPOGLYPHCLIENTUNITY-->>playeractor: 5. Prompts for Platform Service Sign-In\n    \n    alt User consents to sign-in\n        REPOGLYPHCLIENTUNITY->>platformservicesactor: 6.1.1. Initiates sign-in flow\n        activate platformservicesactor\n        platformservicesactor-->>playeractor: 6.1.2. Presents native sign-in UI\n        playeractor->>platformservicesactor: 6.1.3. Enters credentials & consents\n        platformservicesactor-->>REPOGLYPHCLIENTUNITY: 6.1.4. Platform Auth Token, PlayerID\n        deactivate platformservicesactor\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHAUTH: 6.1.5. POST /auth/platform { platformToken }\n        activate REPOGLYPHAUTH\n        REPOGLYPHAUTH->>REPOGLYPHAUTH: 6.1.5.1. Validate token, find/create user, generate JWT\n        REPOGLYPHAUTH-->>REPOGLYPHCLIENTUNITY: Game Session JWT, Player Profile\n        deactivate REPOGLYPHAUTH\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 6.1.6. Stores JWT for session\n    else User declines or skips sign-in\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 6.2.1. Proceeds with a guest session\n    end\n    \n    opt First Time User Experience\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 7.1. Loads interactive tutorial data (locally)\n        loop For each tutorial step\n            REPOGLYPHCLIENTUNITY-->>playeractor: 7.2.1. Presents tutorial instructions\n            playeractor->>REPOGLYPHCLIENTUNITY: 7.2.2. Performs required action (e.g., swipe)\n            REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 7.2.3. Validates action\n        end\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 7.3. Saves tutorial completion status locally\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHPLAYER: 7.4. POST /player/progress { tutorialCompleted: true }\n        activate REPOGLYPHPLAYER\n        REPOGLYPHPLAYER->>REPOGLYPHPLAYER: 7.4.1. Updates player data in database\n        REPOGLYPHPLAYER-->>REPOGLYPHCLIENTUNITY: 200 OK\n        deactivate REPOGLYPHPLAYER\n    end\n    \n    REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 8. Loads Level 1 data (hand-crafted, from local assets)\n    REPOGLYPHCLIENTUNITY-->>playeractor: 9. Renders Level 1 grid and HUD\n    \n    loop Gameplay\n        playeractor->>REPOGLYPHCLIENTUNITY: 10.1. Draws path on grid\n        REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 10.2. Validates move against level rules\n        REPOGLYPHCLIENTUNITY-->>playeractor: 10.3. Updates path rendering (visual feedback)\n    end\n    \n    REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 11. Detects win condition (all glyphs connected)\n    REPOGLYPHCLIENTUNITY->>REPOGLYPHCLIENTUNITY: 12. Calculates final score\n    REPOGLYPHCLIENTUNITY-->>playeractor: 13. Displays 'Level Complete' screen with score\n    playeractor->>REPOGLYPHCLIENTUNITY: 14. Taps 'Continue'\n    \n    REPOGLYPHCLIENTUNITY->>REPOGLYPHLEADERBOARD: 15. POST /leaderboards/{levelId}/scores\n    activate REPOGLYPHLEADERBOARD\n    note right of REPOGLYPHLEADERBOARD: The client generates a validation hash based on gameplay events to be sent with the score. The server uses this to perform basic cheat detection.\n    REPOGLYPHLEADERBOARD->>REPOGLYPHLEADERBOARD: 15.1. Performs server-side score validation\n    REPOGLYPHLEADERBOARD->>REPOGLYPHLEADERBOARD: 15.2. Persists new score in database\n    REPOGLYPHLEADERBOARD-->>REPOGLYPHCLIENTUNITY: 201 Created\n    deactivate REPOGLYPHLEADERBOARD\n    \n    REPOGLYPHCLIENTUNITY-->>playeractor: 16. Displays Level Selection screen\n    deactivate REPOGLYPHCLIENTUNITY"
}
