story_id,epic,title,user_role,description,priority,story_points,dependencies,acceptance_criteria_1,acceptance_criteria_2,acceptance_criteria_3,technical_tasks,definition_of_done
US-001,"Project Scaffolding and Core Configuration",Set up Project Dependencies and Scripts,Developer,"As a Developer, I want a configured `package.json` file so that I can easily install project dependencies and run common development, build, and start commands.","Must Have",3,"","Given the project's `package.json` is defined with all dependencies, When a developer runs the `npm install` command, Then the command completes successfully and all production and development dependencies are installed in the `node_modules` directory.","Given the project's `package.json` has `start`, `build`, and `dev` scripts defined, When a developer runs `npm run build`, Then the TypeScript compiler (`tsc`) is executed successfully.","Given the project's `package.json` has `start` and `dev` scripts defined, When a developer runs `npm start` or `npm run dev`, Then the application server starts correctly either in production mode or development mode with hot-reloading.","Create and configure package.json: Initialize an npm project and populate the `package.json` with all specified production and development dependencies. Define `start`, `build`, and `dev` scripts.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-002,"Project Scaffolding and Core Configuration",Configure TypeScript Compilation,Developer,"As a Developer, I want a `tsconfig.json` file so that the TypeScript code is compiled consistently with strict type-checking and modern JavaScript output.","Must Have",1,"","Given the `tsconfig.json` file is present in the project root, When I inspect the file, Then it contains the specified compiler options including `target: ES2020`, `module: CommonJS`, `strict: true`, and correct pathing for `rootDir` and `outDir`.","Given the project has TypeScript source files in the `src` directory, When I run the `npm run build` command, Then the TypeScript compiler (`tsc`) successfully transpiles the code into JavaScript files in the `dist` directory without errors.","","Configure TypeScript (`tsconfig.json`): Create the `tsconfig.json` file to configure the TypeScript compiler settings as per the SDS, including target, module system, strictness, and paths.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-003,"Project Scaffolding and Core Configuration",Implement Type-Safe Environment Configuration,Developer,"As a Developer, I want a centralized, type-safe configuration module so that I can access environment variables reliably and prevent the application from starting with a missing configuration.","Must Have",3,"","Given the `.env.example` file is defined with all required keys, When a developer creates a `.env` file and provides all necessary values, Then the application can import and access these values from the `src/config/index.ts` module as a frozen, typed object.","Given a required environment variable (e.g., `PLAYER_SERVICE_URL`) is missing from the environment, When the application attempts to start, Then it throws a descriptive error and exits immediately.","","Setup Environment Variable Handling: Create the `.env.example` template and the `src/config/index.ts` module to load, validate, and provide type-safe access to all environment variables.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-004,"Project Scaffolding and Core Configuration",Implement a Centralized and Structured Logger,Developer,"As a Developer, I want a centralized logger so that I can produce consistent, structured logs for easier debugging and monitoring across different environments.","Must Have",2,US-003,"Given the logger is configured, When I run the application in a development environment, Then log messages are output to the console in a simple, colorized format.","Given the logger is configured, When I run the application in a production environment (e.g., `NODE_ENV=production`), Then log messages are output to the console in a structured JSON format.","Given the logger is imported into any module, When I call `logger.info('message')`, Then the message is logged at the 'info' level according to the environment's format settings.","Implement Centralized Logger: Create the `src/utils/logger.ts` module to provide a singleton Winston logger instance. The logger should have different formats for development (simple, colorized) and production (JSON).","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-005,"Application Assembly and Core Middleware",Implement Global API Rate Limiting,System Administrator,"As a System Administrator, I want to enforce a global rate limit on incoming requests so that the API gateway and downstream services are protected from abuse and denial-of-service attacks.","Must Have",2,US-003,"Given the rate limiting middleware is enabled with a maximum of 100 requests per window, When a client makes 100 requests within the configured time window, Then all requests receive a 2xx or 4xx status code and include `RateLimit-*` headers in the response.","Given the rate limiting middleware is enabled with a maximum of 100 requests per window, When a client makes the 101st request within the same time window, Then the client receives a 429 'Too Many Requests' status code.","","Implement Rate Limiting Middleware: Create `src/middleware/rateLimit.middleware.ts` to configure and export the `express-rate-limit` middleware.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-006,"Application Assembly and Core Middleware",Assemble Core Application and Middleware Pipeline,Developer,"As a Developer, I want a main application file (`app.ts`) that assembles all core middleware in the correct order so that security, request processing, and error handling are applied consistently to all requests.","Must Have",3,"US-003,US-004,US-005","Given the Express application is running, When a client sends a request, Then the response includes security headers set by Helmet.","Given the application is running with a configured CORS origin, When a browser from that origin makes a request, Then the request is not blocked by CORS policy.","Given a request is made to an undefined route (e.g., `/non-existent-path`), When the server responds, Then it returns a 404 Not Found status.","Assemble the Main Application (`src/app.ts`): Create the Express `app` instance in `src/app.ts`. Configure the main middleware pipeline in the correct order: CORS, Helmet, JSON body parser, request logger, and global rate limiter. Also include 404 and global error handlers.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-007,"Application Assembly and Core Middleware",Create Server Entry Point with Graceful Shutdown,System Administrator,"As a System Administrator, I want the application to have a dedicated server entry point that supports graceful shutdown so that the service can be stopped cleanly without dropping active connections during deployments.","Must Have",2,US-006,"Given the application is configured to run on a specific port, When I start the server using `npm start`, Then it successfully starts and logs a message indicating it is listening on that port.","Given the server is running with active connections, When the process receives a `SIGINT` or `SIGTERM` signal, Then the server stops accepting new connections, allows existing requests to complete, and then shuts down gracefully.","","Create the Server Entry Point (`src/server.ts`): Create the application's main entry point. This file will import the `app`, create an `http.Server`, and start listening on the configured port. It must include graceful shutdown logic.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-008,"Request Routing and Proxying",Create a Reusable Request Proxying Middleware,Developer,"As a Developer, I want a reusable proxy middleware factory so that I can easily create and configure proxies to forward requests to various downstream microservices.","Must Have",5,"","Given the proxy factory is used to create middleware for a target service, When a request is made to the gateway, Then the request path, method, headers, and body are correctly forwarded to the target service.","Given the JWT auth middleware has attached a user object to `req.user`, When the request is proxied, Then the user object is serialized and included in a custom `x-user-context` header on the forwarded request.","","Implement Proxy Middleware Factory: Create `src/middleware/proxy.middleware.ts`. This file will export a factory function `createProxy(targetUrl)` that returns a configured `express-http-proxy` instance.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-009,"Request Routing and Proxying",Define and Configure Gateway Routing Logic,Developer,"As a Developer, I want a centralized routing module so that I can declaratively define all API routes, their target services, and their security requirements.","Must Have",5,"US-003,US-008,US-011","Given the router is configured, When a request is made to a public path like `/auth/login`, Then it is proxied directly to the Auth service without an authentication check.","Given the router is configured, When a request is made to a protected path like `/player/profile` with a valid JWT, Then it successfully passes the authentication check and is proxied to the Player service.","Given the router is configured, When a request is made to a protected path like `/player/profile` without a JWT, Then the request is rejected by the authentication middleware with a 401/403 status and is not proxied.","Define and Configure Master Router: Create `src/routes/index.ts`. This module will define a `routeConfig` array and iterate over it to programmatically build the Express router, applying auth middleware and the proxy middleware for each route.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-010,"Request Routing and Proxying",Integrate Master Router into Application,Developer,"As a Developer, I want to mount the master router into the main Express application so that incoming requests are correctly handled by the routing logic.","Must Have",1,"US-006,US-009","Given the master router is defined in `src/routes/index.ts`, When it is mounted in `src/app.ts`, Then requests to configured paths like `/player/profile` are correctly processed by the router's middleware and proxy logic.","Given the master router is mounted, When a request is made to a path that is not defined in the router, Then the request falls through to the application's 404 handler.","","Integrate Router into Application: Update `src/app.ts` to import and use the master router from `src/routes/index.ts`.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-011,"Authentication and Authorization",Implement JWT Verification Middleware,Developer,"As a Developer, I want a secure authentication middleware so that I can protect API routes by validating JSON Web Tokens (JWTs) against a remote JSON Web Key Set (JWKS).","Must Have",8,US-003,"Given a request is made to a protected route with a valid `Authorization: Bearer <token>` header, When the middleware processes the request, Then the token is successfully verified against the remote JWKS and the request proceeds with the decoded user payload attached to `req.user`.","Given a request is made to a protected route with an invalid, malformed, or expired token, When the middleware processes the request, Then it rejects the request with a 403 Forbidden status code.","Given a request is made to a protected route with no `Authorization` header, When the middleware processes the request, Then it rejects the request with a 401 Unauthorized status code.","Implement JWT Verification Middleware (`auth.middleware.ts`): Create `src/middleware/auth.middleware.ts`. This async middleware will extract the Bearer token, fetch the remote JWKS, verify the token's signature and claims using the `jose` library, and attach the payload to `req.user`.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-012,"API Documentation",Serve Interactive API Documentation,Developer,"As a client Developer, I want to access interactive API documentation so that I can easily discover, understand, and test the gateway's endpoints.","Should Have",2,"","Given the Swagger module is configured and integrated, When I navigate my browser to the `/api-docs` endpoint, Then the Swagger UI interface is displayed.","Given the Swagger UI is loaded, When I inspect the page, Then it displays a title, version, and a list of API endpoints grouped by tags.","Given the documentation defines a JWT Bearer security scheme, When I view the UI, Then there is an 'Authorize' button that allows me to input a JWT to authenticate subsequent requests made from the UI.","Configure Swagger Documentation Generation: Create `src/docs/swagger.ts`. This module will configure `swagger-jsdoc` with the OpenAPI 3.0 definition, including info, servers, and security schemes for JWT Bearer auth. It will then use `swagger-ui-express` to serve the generated spec.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-013,"API Documentation",Document API Routes with OpenAPI Annotations,Developer,"As a client Developer, I want the API documentation to be accurate and automatically generated from the source code so that it is always up-to-date with the latest routing changes.","Should Have",3,"US-009,US-012","Given the routes in `src/routes/index.ts` are annotated with JSDoc comments, When I view the `/api-docs` page, Then the documentation accurately lists all the proxied service endpoints.","Given a route is marked as requiring authentication in the `routeConfig`, When I view its documentation on the `/api-docs` page, Then it is marked with a lock icon or similar indicator signifying it is a protected endpoint.","","Add JSDoc Annotations to Routes: Annotate the route definitions in `src/routes/index.ts` with JSDoc comments that follow the OpenAPI specification. This should describe the endpoints, parameters, responses, and security requirements.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-014,"Containerization and Deployment",Containerize the Application for Production,System Administrator,"As a System Administrator, I want a multi-stage Dockerfile so that I can build a small, secure, and optimized container image for production deployment.","Should Have",5,"US-001,US-002","Given the `Dockerfile` and `.dockerignore` files are present, When I run the `docker build .` command, Then it successfully completes a multi-stage build and creates a final container image.","Given the Docker image has been built, When I inspect the final image, Then it does not contain source code (e.g., the `src` directory) or development dependencies.","Given the Docker image is built, When I run a container from the image and provide the necessary environment variables, Then the API gateway application starts successfully.","Create a multi-stage Dockerfile: Develop a `Dockerfile` that uses a multi-stage build. The first stage (`build`) will use a full Node.js image to install dependencies and compile the TypeScript. The final stage will use a slim Node.js image (e.g., `node:18-alpine`), copy over only the `dist` folder, `node_modules`, and `package.json`, and set the `CMD` to run the application.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."
US-015,"Containerization and Deployment",Expose a Health Check Endpoint,System Administrator,"As a System Administrator, I want a dedicated health check endpoint so that container orchestrators (like Kubernetes) can automatically determine the application's health and manage its lifecycle.","Should Have",1,US-006,"Given the application is running, When I make a GET request to the `/healthz` endpoint, Then the server responds with a 200 OK status code.","Given the health check endpoint is defined, When I make a request to it, Then the response body is a simple JSON object, such as `{\"status\": \"ok\"}`.","Given the health check endpoint exists, When a request is made to it, Then it does not go through the authentication or proxying middleware.","Add a Health Check Endpoint: Add a simple, unproxied health check endpoint (e.g., `/healthz`) to the application in `app.ts` that returns a 200 OK status. This is crucial for container orchestrators.","Code is complete and adheres to coding standards. All acceptance criteria are met. Unit tests are written and passing with sufficient coverage. The feature is peer-reviewed and merged into the main branch. Any related documentation is updated."